<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:jmix="http://jmix.io/schema/bpm/bpmn" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsd="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.flowable.org/processdef" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL http://www.omg.org/spec/BPMN/2.0/20100501/BPMN20.xsd">
  <process id="pizza-process" name="Pizza process" isExecutable="true" flowable:candidateStarterUsers="peter" jmix:candidateStarterUsersValue="peter">
    <startEvent id="startEvent1">
      <extensionElements>
        <jmix:processVariables>
          <jmix:processVariable name="pizza" type="entity-list">
            <jmix:processVariableProperty name="entityName" value="jbt_User" />
          </jmix:processVariable>
        </jmix:processVariables>
        <jmix:formData type="input-dialog" openMode="DIALOG">
          <jmix:formFields>
            <jmix:formField id="pizzaEater" caption="Pizza eater" type="entity" editable="true" required="true">
              <jmix:formFieldProperty name="entityName" value="jbt_User" />
              <jmix:formFieldProperty name="uiComponent" value="entityPicker" />
              <jmix:formFieldProperty name="lookupScreen" value="jbt_User.list" />
            </jmix:formField>
            <jmix:formField id="approver" caption="Approver" type="entity" editable="true" required="false">
              <jmix:formFieldProperty name="entityName" value="jbt_User" />
              <jmix:formFieldProperty name="uiComponent" value="comboBox" />
              <jmix:formFieldProperty name="query" value="select j from jbt_User j &#10;where j.position = &#39;accountant&#39;" />
            </jmix:formField>
            <jmix:formField id="messege" caption="Messege" type="string" editable="true" required="false" />
          </jmix:formFields>
        </jmix:formData>
      </extensionElements>
      <outgoing>Flow_1ksg30u</outgoing>
    </startEvent>
    <sequenceFlow id="Flow_1ksg30u" sourceRef="startEvent1" targetRef="Activity_0xumsoy" />
    <sequenceFlow id="Flow_1aip9l4" sourceRef="Activity_0xumsoy" targetRef="Gateway_0au4xu1" />
    <sequenceFlow id="Flow_0x1hbc4" sourceRef="Activity_115xye0" targetRef="Gateway_04e4hg2" />
    <endEvent id="Event_0345ohs">
      <incoming>Flow_15sp9r7</incoming>
    </endEvent>
    <sequenceFlow id="Flow_15sp9r7" sourceRef="Activity_0n68xkc" targetRef="Event_0345ohs">
      <extensionElements>
        <jmix:conditionDetails conditionSource="userTaskOutcome" />
      </extensionElements>
    </sequenceFlow>
    <userTask id="Activity_0xumsoy" name="Select pizza" flowable:assignee="${pizzaEater.username}" jmix:assigneeSource="processVariable" jmix:assigneeValue="pizzaEater">
      <extensionElements>
        <jmix:formData type="input-dialog" openMode="DIALOG">
          <jmix:formFields>
            <jmix:formField id="pizza" caption="Pizza" type="entity" editable="true" required="false">
              <jmix:formFieldProperty name="entityName" value="jbt_PizzaItem" />
              <jmix:formFieldProperty name="uiComponent" value="entityPicker" />
              <jmix:formFieldProperty name="lookupScreen" value="jbt_PizzaItem.list" />
            </jmix:formField>
            <jmix:formField id="specialRequirement" caption="Special requirement" type="multilineString" editable="true" required="false" />
          </jmix:formFields>
          <jmix:formOutcomes>
            <jmix:formOutcome id="yes" caption="Yes" icon="APPLE" />
            <jmix:formOutcome id="no" caption="No" icon="BAN" />
          </jmix:formOutcomes>
        </jmix:formData>
      </extensionElements>
      <incoming>Flow_1ksg30u</incoming>
      <outgoing>Flow_1aip9l4</outgoing>
    </userTask>
    <userTask id="Activity_115xye0" name="Approve order" flowable:candidateGroups=" " jmix:assigneeSource="userProvider" jmix:assigneeValue="jbt_TaskPerformer" jmix:candidateGroupsValue=" ">
      <extensionElements>
        <jmix:formData type="input-dialog" openMode="DIALOG">
          <jmix:formFields>
            <jmix:formField id="initiator" caption="Initiator" type="entity" editable="false" required="false">
              <jmix:formFieldProperty name="entityName" value="jbt_User" />
              <jmix:formFieldProperty name="uiComponent" value="entityPicker" />
              <jmix:formFieldProperty name="lookupScreen" value="jbt_User.list" />
            </jmix:formField>
            <jmix:formField id="pizza" caption="Pizza" type="entity" editable="true" required="false">
              <jmix:formFieldProperty name="entityName" value="jbt_PizzaItem" />
              <jmix:formFieldProperty name="uiComponent" value="entityPicker" />
              <jmix:formFieldProperty name="lookupScreen" value="jbt_PizzaItem.list" />
            </jmix:formField>
          </jmix:formFields>
          <jmix:formOutcomes>
            <jmix:formOutcome id="approve" caption="Approve" />
            <jmix:formOutcome id="reject" caption="Reject" />
          </jmix:formOutcomes>
        </jmix:formData>
        <jmix:springBean beanName="jbt_TaskPerformer" methodName="getUser" />
      </extensionElements>
      <incoming>Flow_0th938y</incoming>
      <outgoing>Flow_0x1hbc4</outgoing>
    </userTask>
    <userTask id="Activity_0n68xkc" name="Place order" flowable:assignee="peter" jmix:assigneeSource="expression" jmix:assigneeValue="peter">
      <incoming>Flow_1jxvndk</incoming>
      <outgoing>Flow_15sp9r7</outgoing>
    </userTask>
    <exclusiveGateway id="Gateway_04e4hg2" default="Flow_1jxvndk">
      <incoming>Flow_0x1hbc4</incoming>
      <outgoing>Flow_1d8p92f</outgoing>
      <outgoing>Flow_1jxvndk</outgoing>
    </exclusiveGateway>
    <sequenceFlow id="Flow_1jxvndk" name="Yes" sourceRef="Gateway_04e4hg2" targetRef="Activity_0n68xkc">
      <extensionElements>
        <jmix:conditionDetails conditionSource="expression" />
      </extensionElements>
    </sequenceFlow>
    <endEvent id="Event_0r77cac">
      <incoming>Flow_1d8p92f</incoming>
    </endEvent>
    <sequenceFlow id="Flow_1d8p92f" name="No" sourceRef="Gateway_04e4hg2" targetRef="Event_0r77cac">
      <extensionElements>
        <jmix:conditionDetails conditionSource="userTaskOutcome" conditionType="anyoneCompleted" userTaskId="Activity_115xye0" userTaskOutcome="reject" />
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression">${execution.getVariable('Activity_115xye0_result') != null &amp;&amp; bpm_UserTaskResults.containsOutcome(execution.getVariable('Activity_115xye0_result'), 'reject')}</conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="Gateway_0au4xu1" default="Flow_0th938y">
      <incoming>Flow_1aip9l4</incoming>
      <outgoing>Flow_0th938y</outgoing>
      <outgoing>Flow_1wzhhxz</outgoing>
    </exclusiveGateway>
    <sequenceFlow id="Flow_0th938y" sourceRef="Gateway_0au4xu1" targetRef="Activity_115xye0" />
    <endEvent id="Event_060j7oj">
      <incoming>Flow_1wzhhxz</incoming>
    </endEvent>
    <sequenceFlow id="Flow_1wzhhxz" name="No" sourceRef="Gateway_0au4xu1" targetRef="Event_060j7oj">
      <extensionElements>
        <jmix:conditionDetails conditionSource="userTaskOutcome" conditionType="anyoneCompleted" userTaskId="Activity_0xumsoy" userTaskOutcome="no" />
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression">${execution.getVariable('Activity_0xumsoy_result') != null &amp;&amp; bpm_UserTaskResults.containsOutcome(execution.getVariable('Activity_0xumsoy_result'), 'no')}</conditionExpression>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_process">
    <bpmndi:BPMNPlane id="BPMNPlane_process" bpmnElement="pizza-process">
      <bpmndi:BPMNShape id="BPMNShape_startEvent1" bpmnElement="startEvent1">
        <omgdc:Bounds x="132" y="150" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0345ohs_di" bpmnElement="Event_0345ohs">
        <omgdc:Bounds x="862" y="150" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1i581iw_di" bpmnElement="Activity_0xumsoy">
        <omgdc:Bounds x="240" y="128" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0rsfkhh_di" bpmnElement="Activity_115xye0">
        <omgdc:Bounds x="460" y="128" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0v272ps_di" bpmnElement="Activity_0n68xkc">
        <omgdc:Bounds x="700" y="128" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_04e4hg2_di" bpmnElement="Gateway_04e4hg2" isMarkerVisible="true">
        <omgdc:Bounds x="605" y="143" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0r77cac_di" bpmnElement="Event_0r77cac">
        <omgdc:Bounds x="612" y="262" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0au4xu1_di" bpmnElement="Gateway_0au4xu1" isMarkerVisible="true">
        <omgdc:Bounds x="375" y="143" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_060j7oj_di" bpmnElement="Event_060j7oj">
        <omgdc:Bounds x="382" y="262" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1ksg30u_di" bpmnElement="Flow_1ksg30u">
        <omgdi:waypoint x="168" y="168" />
        <omgdi:waypoint x="240" y="168" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1aip9l4_di" bpmnElement="Flow_1aip9l4">
        <omgdi:waypoint x="340" y="168" />
        <omgdi:waypoint x="375" y="168" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0x1hbc4_di" bpmnElement="Flow_0x1hbc4">
        <omgdi:waypoint x="560" y="168" />
        <omgdi:waypoint x="605" y="168" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_15sp9r7_di" bpmnElement="Flow_15sp9r7">
        <omgdi:waypoint x="800" y="168" />
        <omgdi:waypoint x="862" y="168" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1jxvndk_di" bpmnElement="Flow_1jxvndk">
        <omgdi:waypoint x="655" y="168" />
        <omgdi:waypoint x="700" y="168" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="669" y="150" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1d8p92f_di" bpmnElement="Flow_1d8p92f">
        <omgdi:waypoint x="630" y="193" />
        <omgdi:waypoint x="630" y="262" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="638" y="225" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0th938y_di" bpmnElement="Flow_0th938y">
        <omgdi:waypoint x="425" y="168" />
        <omgdi:waypoint x="460" y="168" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1wzhhxz_di" bpmnElement="Flow_1wzhhxz">
        <omgdi:waypoint x="400" y="193" />
        <omgdi:waypoint x="400" y="262" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="408" y="225" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
